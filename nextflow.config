includeConfig "${projectDir}/conf/base.config"
params {
    sample_sheet = null
    phased_vcf_dir = null
    reference_fa = null
    gencode_gtf = null
    regions_vcf = null
    outdir = null
}

profiles {
    hpc {
        process {
            executor = 'slurm'
            queue = 'mpcs.p'
            cpus = { 4 * task.attempt }
            memory = { 32.GB * task.attempt }
            time = { 1.d * task.attempt }
            withName: 'STAR_GENOME_INDEX' {
                queue = 'mpcs.p'
                cpus = { 16 * task.attempt }
                memory = { 48.GB * task.attempt }
                time = { 1.d * task.attempt }
            }
            withName: 'STAR_ALIGNMENT_WASP' {
                queue = 'mpcs.p'
                cpus = { 32 * task.attempt }
                memory = { 64.GB * task.attempt }
                time = { 1.d * task.attempt }
            }
            withName: 'SUBSET_1KGP_VCF' {
                queue = 'mpcs.p'
                cpus = { 8 * task.attempt }
                memory = { 32.GB * task.attempt }
                time = { 1.d * task.attempt }
            }
        }
        workDir = "${System.getenv('WORK')}/nf-rna-wasp-allele-count_work"
        singularity.enabled = true
        singularity.autoMounts = true
        singularity.cacheDir = "${projectDir}/container"
        singularity.pullTimeout = '1h'
        docker.enabled = false
        apptainer.enabled = false
    }
    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'
        singularity.enabled = false
        apptainer.enabled = false
    }
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        singularity.cacheDir = "${projectDir}/container"
        docker.enabled = false
        apptainer.enabled = false
    }
    apptainer {
        apptainer.enabled = true
        apptainer.autoMounts = true
        apptainer.cacheDir = "${projectDir}/container"
        docker.enabled = false
        singularity.enabled = false
    }
}
